<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>fase03.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>fase03</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/index-CmLKiEd5.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/preload-helper-DImqtvgl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/react-BcIddLXZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/jsx-runtime-DvsdsEjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-CLazWf1X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/react-dom-D6bRRS5R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/namespace-Cw55ynVb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/cn-CwmWKpZ_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-BiHHvE7B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/menu-items-CE6I2UvI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useEventListener-g9rPKvBX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/tslib.es6-C9vXkBtU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/fullscreen-DoREeXhW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/events-BGfCi1Xy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-DT6vyuIM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/createLucideIcon-Dz-D6iuz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/check-CmOWIaur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/select-DIqNYEaz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/accordion-D8h6M7fo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/chevron-right-kGH9aJGk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dropdown-menu-D3tww20d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/tooltip-CW-4dtRh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/Logger-BkkOJyg0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/hotkeys-ZAWHeY7d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/react-7g8sREeT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_baseIsEqual-BF8660ot.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/invariant-B43sqCFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/merge-BgA7kxZb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/utils-DLuqCLqV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/requests-BW3DqHQI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/once-4nUTgcVU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/toDate-BNd9AHNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_baseSlice-B27Cqkm6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_hasUnicode-CPHpt5EV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/upperFirst-DOlTOwhh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/capitalize-CkrfIDeS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/ai-model-dropdown-D-i9tuGn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/documentation-B7z6bB-t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/badge-Cbb7s63B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/button-g1jf7cM6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/use-toast-BKA5A0CC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/constants-Cv7-oioA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/Deferred-Mppm0cvJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/config-BeIk_wvs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/uuid-4lb_EYpq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/key-Pb6bybhb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/connection-UyRAkvTk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useLifecycle-DmdhGVVs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useNonce-DvpkYOW9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useTheme-BWXNjHkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/createReducer-CFr1RdS2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-BNtnpgX8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-B8v7AWk6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-Ct0a8Isf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-AWYmVWdt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-Q2QzNScK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-BFifaB39.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-D80s9YgJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-Nl79A0iO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-CtJ8WONl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/stex-w1KpyykF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_baseProperty-CIKnF2iY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/now-B6JN1xKT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/debounce-70y9MzDK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/type-CYsuWFDa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/marked.esm-BB_RKOA5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/main-CCaZmKLi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/cells-BEhFXxEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/kbd-CrDndhyw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/renderShortcut-Bjp5Xukk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useEvent-itkPNnCe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useDeleteCell-CIqS2s5l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/icons-15z_NdNZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/spinner-fS9J74Ro.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/datasource-CwGVmPnG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/add-missing-import-0FwDfOhv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/ansi_up-CAiCs1Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/blob-BC4M7Onc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dom-Ckypy4pz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/errors-CmwnOe1B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/extends-B47kqttt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/objectWithoutPropertiesLoose-ClrKK0Xi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/esm-Bp1Lbm07.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/es-Ctpp-mTr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/play-C5VC4Hal.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/sparkles-DLotTEZ2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/shim-FF_l0CN4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/add-cell-with-ai-BQY4AwHL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/ErrorBoundary-Bj7QJPi8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/alert-dialog-DiIW1jDy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dialog-gSaRWBIN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useDebounce-BZnPO5jA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/numbers-P4hvbAnW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/context-BwP_-Md9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useNumberFormatter-BQOmTFFk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/input-DGY-1Oes.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/ImperativeModal-DSAh6fUR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/filename-dpoTdlj9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/cell-link-D8x9Ez3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/alert-D4GhiyiD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/links-DH7hmhHO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/state-5DtoeNLQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/MarimoErrorOutput-CD3rG7IK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/copy-BxPDuBrN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/copy-CGWkBrzb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/copy-icon-7_c6G_tO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/RenderHTML-B398JcWn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/emotion-is-prop-valid.esm-Tm8TdcWf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/with-selector-ChXsBWGQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/JsonOutput-BU4PIFXg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_arrayReduce-DDpPg0Qh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/startCase-DOk4LYuA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/strings-CrHTFiMt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/command-W6QvsWS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/popover-IOch2AIR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/table-CMFDmrFM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/tabs-CswUuyA0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useAsyncData-BB0ZlY9B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/LazyAnyLanguageCodeMirror-CInCxHCy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/error-banner-CHF-jGs2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/defaultLocale-DEWTIUVh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/precisionRound-BLxyDkD7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/defaultLocale-B9-NA0ur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/vega-loader.browser.module-B3yPAbRZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/loader-BcHzCbiy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/formats-Dbfcbsil.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/en-US-D7J6fBFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/isValid-BxWQIw0s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dates-D2l0yAKQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/download-RtEDTktT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/maps-duCv2i7k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useDateFormatter-BapFytxP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/range-BB1DXJJn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/list-filter-DQ2_e3bh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/columns-BeFC1dXm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/focus-BP3h9dJJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useInstallPackage-CDwTdPy7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/column-preview-CC6unPyM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useAddCell-ClSRUhA6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/toggle-DL9DPBMc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useHotkey-CivJpvvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/globals-BGEnYYSz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/mode-kUHLEZT6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/share-ChWJhz87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/dist-I8SxGjN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/memoize-CAcr7Wct.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_toKey-Di_xoXjD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_baseSet-Dmzd-CnA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/utilities.esm-Dj3BexHh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/floating-outline-CwHsH4x8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/eye-off-wMFrY47K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/plus-Ckxr6pwY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/readonly-python-code-DI18L7Ip.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/file-video-camera-D5oKA5-e.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/file-text-Ds68BFYI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/file-BX8VjCCQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/types-Zo5TA9DG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/label-CFxcdBki.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/form-mBAxBzPt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/textarea-BcNYHZLG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/circle-x-CPCvpiTN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/refresh-ccw-D1hQMnx_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/trash-2-Cex53SxB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/form-CN-qI0dC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/field-D-WfasXC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/switch-C2Bk9ykO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useBoolean-7LAl9weo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/useDeepCompareMemoize-CbO9MTKn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/types-TRUculCV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/prop-types-ShpF60yB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/es-W4OhtMWM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/VisuallyHidden-BfudlHw2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_baseFlatten-8yEsQJi9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/get-BYzWDFJH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/hasIn-WaG0qjy7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/_basePickBy-6ZBTv_cn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/pick-BZA77Trx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/square-DpWGO_-7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/chart-no-axes-column-3piSAXMi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/download-CHejLEQn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/globe-TqnwljOq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/send-D9MERKWw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/refresh-cw-CmHE3eNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/settings-ByREbWaw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/square-function-B5j-8u3J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/bundle.esm-BoludFkg.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/documentation-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/columns-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.0/dist/assets/index-DrbV-Ps3.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "fase03.py",
            "mode": "read",
            "version": "0.17.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import pandas as pd\nimport numpy as np\nimport joblib\nfrom tensorflow.keras.models import load_model\nimport math\nimport marimo as mo", "code_hash": "a7d0d498704858b78defba0a74997143", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "N_STEPS = 7\nTARGET_COLUMN_INDEX = 2\nNUM_NUMERIC_FEATURES = 18\n\n# modelo\ntry:\n    model = load_model('best_model.keras')\n    print(\"Modelo 'best_model.keras' cahrgado.\")\nexcept Exception as e:\n    print(f\"Error al cargar 'best_model.keras': {e}\")\n\n# escalador\ntry:\n    scaler = joblib.load('min_max_scaler.joblib')\n    print(\"Escalador 'min_max_scaler.joblib' cargado.\")\nexcept Exception as e:\n    print(f\"Error al cargar 'min_max_scaler.joblib': {e}\")\n\n# codificador de productos\ntry:\n    le_product_id = joblib.load('le_product_id.joblib')\n    print(\"Codificador 'le_product_id.joblib' cargado.\")\nexcept Exception as e:\n    print(f\"Error al cargar 'le_product_id.joblib': {e}\")\n\n# features\ntry:\n    df_features = pd.read_csv('df_processed_features.csv')\n    df_features['created_at'] = pd.to_datetime(df_features['created_at'])\n    print(f\"Base de datos de features cargada ({len(df_features)} registros).\")\nexcept Exception as e:\n    print(f\"Error al cargar 'df_processed_features.csv': {e}\")\n\n# Lista de columnas\nFEATURE_COLUMNS = [\n    'quantity_on_hand', 'quantity_reserved', 'quantity_available',\n    'minimum_stock_level', 'reorder_point', 'optimal_stock_level',\n    'reorder_quantity', 'average_daily_usage', 'unit_cost', 'total_value',\n    'is_active', 'dia_del_mes', 'dia_de_la_semana', 'mes', 'trimestre',\n    'es_fin_de_semana', 'dias_para_vencimiento', 'antiguedad_producto_dias',\n    'ratio_uso_stock', 'product_id_encoded', 'supplier_id_encoded',\n    'warehouse_location_Almac\u00e9n Este', 'warehouse_location_Almac\u00e9n Norte',\n    'warehouse_location_Almac\u00e9n Oeste', 'warehouse_location_Almac\u00e9n Sur',\n    'warehouse_location_Centro Distribuci\u00f3n 1',\n    'warehouse_location_Centro Distribuci\u00f3n 2', 'stock_status_1',\n    'stock_status_2', 'stock_status_3'\n]", "code_hash": "2f51ba2e6f51034a7181edea48202a50", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dwtW", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nSe cargan los artefactos de producci\u00f3n: \n- Modelo \u00f3ptimo `best_model.keras` \n- Escalador `min_max_scaler.joblib` para desescalar predicciones.\n- Codificador `le_product_id.joblib` para validar/convertir `product_id`.\n\nAdem\u00e1s se lee `df_processed_features.csv` (79 174 filas) y se fija la lista de `FEATURE_COLUMNS`. \nEstos objetos garantizan que la inferencia use **exactamente** las mismas transformaciones que en el entrenamiento (consistencia entre train y producci\u00f3n).\n\n\"\"\"\n)", "code_hash": "54883d20479f94f7a5d000d88bf2cf6b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "def predict_demand(product_id_str, target_date_str):\n\n    # Validar y Codificar ID de Producto ---\n    try:\n        product_id_encoded = le_product_id.transform([product_id_str])[0]\n    except ValueError:\n        return f\"Error: El ID de producto '{product_id_str}' no fue visto durante el entrenamiento.\"\n\n    # validar fecha\n    try:\n        target_date = pd.to_datetime(target_date_str)\n    except ValueError:\n        return f\"Error: Formato de fecha incorrecto '{target_date_str}'.\"\n\n    # secuencia hist\u00f3rica\n    product_data = df_features[\n        (df_features['product_id_encoded'] == product_id_encoded)\n    ].sort_values(by='created_at')\n\n    historical_data = product_data[product_data['created_at'] < target_date]\n\n    # validar historia\n    if len(historical_data) < N_STEPS:\n        return (f\"Error: No hay suficiente historia ({len(historical_data)} d\u00edas) \"\n                f\"para predecir. Se necesitan {N_STEPS} d\u00edas.\")\n\n    sequence_df = historical_data.tail(N_STEPS)\n    input_features_df = sequence_df[FEATURE_COLUMNS]\n\n    input_features_scaled = input_features_df.astype(np.float32).values\n    input_sequence = np.expand_dims(input_features_scaled, axis=0)\n\n    # prediccion\n    pred_scaled = model.predict(input_sequence)[0][0]\n\n    # des-escalar\n    dummy_pred = np.zeros((1, NUM_NUMERIC_FEATURES))\n    dummy_pred[:, TARGET_COLUMN_INDEX] = pred_scaled\n\n    pred_real = scaler.inverse_transform(dummy_pred)[0][TARGET_COLUMN_INDEX]\n\n    print(\"predicci\u00f3n realizada\")\n    return max(0, pred_real)", "code_hash": "661e2cce89b02550b2fd4452cffbd709", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nFlujo de inferencia:\n\n1) **Validaci\u00f3n**: \n   - `product_id` se transforma con `LabelEncoder`; si no fue visto en train, se devuelve un mensaje de error.\n   - `target_date` se convierte a `datetime`; si el formato es inv\u00e1lido, se informa al usuario.\n\n2) **Construcci\u00f3n del contexto temporal**:\n   - Se filtra el historial del producto **previo** a `target_date` y se ordena por `created_at`.\n   - Se requieren **N_STEPS (=7)** observaciones; si no hay suficientes d\u00edas, se detiene con mensaje.\n\n3) **Preparaci\u00f3n del input**:\n   - Se toman las \u00faltimas 7 filas (`tail(N_STEPS)`), se seleccionan `FEATURE_COLUMNS`, se castea a `float32` y se expande a forma `(1, 7, 30)`.\n\n4) **Predicci\u00f3n y desescalado**:\n   - El modelo devuelve `pred_scaled` en [0,1]. \n   - Se embebe en un vector \u201cdummy\u201d con `NUM_NUMERIC_FEATURES` para aplicar `inverse_transform` y recuperar unidades reales de `quantity_available` (\u00edndice `TARGET_COLUMN_INDEX`).\n   - Se trunca a `>= 0` y se retorna el valor en **unidades de stock**.\nCon esto, la funci\u00f3n es **determinista y segura** ante entradas no vistas o con historial insuficiente\n\n\"\"\"\n)", "code_hash": "4da907643f63cfe73dd565e1adeb6cce", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "print(\"Prueba 1:\")\nTEST_ID = 'PROD-00136830'\nTEST_DATE = '2025-10-31'\n\nprediccion_1 = predict_demand(TEST_ID, TEST_DATE)\nprint(f\"\\nPredicci\u00f3n para {TEST_ID} el {TEST_DATE}:\")\n\nif isinstance(prediccion_1, (int, float)):\n    print(f\"Stock predicho: {prediccion_1:.2f} unidades\")\nelse:\n    print(f\"Resultado: {prediccion_1}\")\n\nprint()\n\nprint(\"Prueba 2:\")\nTEST_ID = 'PROD-023D0E26'\nTEST_DATE = '2025-10-31'\n\nprediccion_1 = predict_demand(TEST_ID, TEST_DATE)\nprint(f\"\\nPredicci\u00f3n para {TEST_ID} el {TEST_DATE}:\")\n\nif isinstance(prediccion_1, (int, float)):\n    print(f\"Stock predicho: {prediccion_1:.2f} unidades\")\nelse:\n    print(f\"Resultado: {prediccion_1}\")", "code_hash": "76e2a6038e2cd9f31545cb18eb8fb2b9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}], "metadata": {"marimo_version": "0.17.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "a7d0d498704858b78defba0a74997143", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2f51ba2e6f51034a7181edea48202a50", "console": [{"name": "stdout", "text": "Modelo 'best_model.keras' cahrgado.\n", "type": "stream"}, {"name": "stderr", "text": "/home/felipep/Documentos/universidad/universidad 7mo/aprendizaje automatico/.venv/lib/python3.13/site-packages/sklearn/base.py:442: InconsistentVersionWarning: Trying to unpickle estimator MinMaxScaler from version 1.6.1 when using version 1.7.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:\nhttps://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations\n  warnings.warn(\n", "type": "stream"}, {"name": "stdout", "text": "Escalador 'min_max_scaler.joblib' cargado.\nCodificador 'le_product_id.joblib' cargado.\n", "type": "stream"}, {"name": "stdout", "text": "Base de datos de features cargada (79174 registros).\n", "type": "stream"}], "id": "dwtW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "54883d20479f94f7a5d000d88bf2cf6b", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Se cargan los artefactos de producci\u00f3n:</span>\n<ul>\n<li>Modelo \u00f3ptimo <code>best_model.keras</code></li>\n<li>Escalador <code>min_max_scaler.joblib</code> para desescalar predicciones.</li>\n<li>Codificador <code>le_product_id.joblib</code> para validar/convertir <code>product_id</code>.</li>\n</ul>\n<span class=\"paragraph\">Adem\u00e1s se lee <code>df_processed_features.csv</code> (79 174 filas) y se fija la lista de <code>FEATURE_COLUMNS</code>.\nEstos objetos garantizan que la inferencia use <strong>exactamente</strong> las mismas transformaciones que en el entrenamiento (consistencia entre train y producci\u00f3n).</span></span>"}, "type": "data"}]}, {"code_hash": "661e2cce89b02550b2fd4452cffbd709", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "4da907643f63cfe73dd565e1adeb6cce", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Flujo de inferencia:</span>\n<span class=\"paragraph\">1) <strong>Validaci\u00f3n</strong>:</span>\n<span class=\"paragraph\">- <code>product_id</code> se transforma con <code>LabelEncoder</code>; si no fue visto en train, se devuelve un mensaje de error.</span>\n<span class=\"paragraph\">- <code>target_date</code> se convierte a <code>datetime</code>; si el formato es inv\u00e1lido, se informa al usuario.</span>\n<span class=\"paragraph\">2) <strong>Construcci\u00f3n del contexto temporal</strong>:</span>\n<span class=\"paragraph\">- Se filtra el historial del producto <strong>previo</strong> a <code>target_date</code> y se ordena por <code>created_at</code>.</span>\n<span class=\"paragraph\">- Se requieren <strong>N_STEPS (=7)</strong> observaciones; si no hay suficientes d\u00edas, se detiene con mensaje.</span>\n<span class=\"paragraph\">3) <strong>Preparaci\u00f3n del input</strong>:</span>\n<span class=\"paragraph\">- Se toman las \u00faltimas 7 filas (<code>tail(N_STEPS)</code>), se seleccionan <code>FEATURE_COLUMNS</code>, se castea a <code>float32</code> y se expande a forma <code>(1, 7, 30)</code>.</span>\n<span class=\"paragraph\">4) <strong>Predicci\u00f3n y desescalado</strong>:</span>\n<span class=\"paragraph\">- El modelo devuelve <code>pred_scaled</code> en [0,1].</span>\n<span class=\"paragraph\">- Se embebe en un vector \u201cdummy\u201d con <code>NUM_NUMERIC_FEATURES</code> para aplicar <code>inverse_transform</code> y recuperar unidades reales de <code>quantity_available</code> (\u00edndice <code>TARGET_COLUMN_INDEX</code>).</span>\n<span class=\"paragraph\">- Se trunca a <code>&gt;= 0</code> y se retorna el valor en <strong>unidades de stock</strong>.\nCon esto, la funci\u00f3n es <strong>determinista y segura</strong> ante entradas no vistas o con historial insuficiente</span></span>"}, "type": "data"}]}, {"code_hash": "76e2a6038e2cd9f31545cb18eb8fb2b9", "console": [{"name": "stdout", "text": "Prueba 1:\n", "type": "stream"}, {"name": "stdout", "text": "\r\u001b[1m1/1\u001b[0m \u001b[32m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 15ms/step", "type": "stream"}, {"name": "stdout", "text": "\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r\u001b[1m1/1\u001b[0m \u001b[32m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 27ms/step\npredicci\u00f3n realizada\n\nPredicci\u00f3n para PROD-00136830 el 2025-10-31:\nStock predicho: 2892.32 unidades\n\nPrueba 2:\n", "type": "stream"}, {"name": "stdout", "text": "\r\u001b[1m1/1\u001b[0m \u001b[32m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 15ms/step", "type": "stream"}, {"name": "stdout", "text": "\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r\u001b[1m1/1\u001b[0m \u001b[32m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 33ms/step\npredicci\u00f3n realizada\n\nPredicci\u00f3n para PROD-023D0E26 el 2025-10-31:\nStock predicho: 2967.88 unidades\n", "type": "stream"}], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20joblib%0A%20%20%20%20from%20tensorflow.keras.models%20import%20load_model%0A%20%20%20%20import%20math%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20joblib%2C%20load_model%2C%20mo%2C%20np%2C%20pd%0A%0A%0A%40app.cell%0Adef%20_(joblib%2C%20load_model%2C%20pd)%3A%0A%20%20%20%20N_STEPS%20%3D%207%0A%20%20%20%20TARGET_COLUMN_INDEX%20%3D%202%0A%20%20%20%20NUM_NUMERIC_FEATURES%20%3D%2018%0A%0A%20%20%20%20%23%20modelo%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20model%20%3D%20load_model('best_model.keras')%0A%20%20%20%20%20%20%20%20print(%22Modelo%20'best_model.keras'%20cahrgado.%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22Error%20al%20cargar%20'best_model.keras'%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%23%20escalador%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20scaler%20%3D%20joblib.load('min_max_scaler.joblib')%0A%20%20%20%20%20%20%20%20print(%22Escalador%20'min_max_scaler.joblib'%20cargado.%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22Error%20al%20cargar%20'min_max_scaler.joblib'%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%23%20codificador%20de%20productos%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20le_product_id%20%3D%20joblib.load('le_product_id.joblib')%0A%20%20%20%20%20%20%20%20print(%22Codificador%20'le_product_id.joblib'%20cargado.%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22Error%20al%20cargar%20'le_product_id.joblib'%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%23%20features%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20df_features%20%3D%20pd.read_csv('df_processed_features.csv')%0A%20%20%20%20%20%20%20%20df_features%5B'created_at'%5D%20%3D%20pd.to_datetime(df_features%5B'created_at'%5D)%0A%20%20%20%20%20%20%20%20print(f%22Base%20de%20datos%20de%20features%20cargada%20(%7Blen(df_features)%7D%20registros).%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22Error%20al%20cargar%20'df_processed_features.csv'%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%23%20Lista%20de%20columnas%0A%20%20%20%20FEATURE_COLUMNS%20%3D%20%5B%0A%20%20%20%20%20%20%20%20'quantity_on_hand'%2C%20'quantity_reserved'%2C%20'quantity_available'%2C%0A%20%20%20%20%20%20%20%20'minimum_stock_level'%2C%20'reorder_point'%2C%20'optimal_stock_level'%2C%0A%20%20%20%20%20%20%20%20'reorder_quantity'%2C%20'average_daily_usage'%2C%20'unit_cost'%2C%20'total_value'%2C%0A%20%20%20%20%20%20%20%20'is_active'%2C%20'dia_del_mes'%2C%20'dia_de_la_semana'%2C%20'mes'%2C%20'trimestre'%2C%0A%20%20%20%20%20%20%20%20'es_fin_de_semana'%2C%20'dias_para_vencimiento'%2C%20'antiguedad_producto_dias'%2C%0A%20%20%20%20%20%20%20%20'ratio_uso_stock'%2C%20'product_id_encoded'%2C%20'supplier_id_encoded'%2C%0A%20%20%20%20%20%20%20%20'warehouse_location_Almac%C3%A9n%20Este'%2C%20'warehouse_location_Almac%C3%A9n%20Norte'%2C%0A%20%20%20%20%20%20%20%20'warehouse_location_Almac%C3%A9n%20Oeste'%2C%20'warehouse_location_Almac%C3%A9n%20Sur'%2C%0A%20%20%20%20%20%20%20%20'warehouse_location_Centro%20Distribuci%C3%B3n%201'%2C%0A%20%20%20%20%20%20%20%20'warehouse_location_Centro%20Distribuci%C3%B3n%202'%2C%20'stock_status_1'%2C%0A%20%20%20%20%20%20%20%20'stock_status_2'%2C%20'stock_status_3'%0A%20%20%20%20%5D%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20FEATURE_COLUMNS%2C%0A%20%20%20%20%20%20%20%20NUM_NUMERIC_FEATURES%2C%0A%20%20%20%20%20%20%20%20N_STEPS%2C%0A%20%20%20%20%20%20%20%20TARGET_COLUMN_INDEX%2C%0A%20%20%20%20%20%20%20%20df_features%2C%0A%20%20%20%20%20%20%20%20le_product_id%2C%0A%20%20%20%20%20%20%20%20model%2C%0A%20%20%20%20%20%20%20%20scaler%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Se%20cargan%20los%20artefactos%20de%20producci%C3%B3n%3A%20%0A%20%20%20%20-%20Modelo%20%C3%B3ptimo%20%60best_model.keras%60%20%0A%20%20%20%20-%20Escalador%20%60min_max_scaler.joblib%60%20para%20desescalar%20predicciones.%0A%20%20%20%20-%20Codificador%20%60le_product_id.joblib%60%20para%20validar%2Fconvertir%20%60product_id%60.%0A%0A%20%20%20%20Adem%C3%A1s%20se%20lee%20%60df_processed_features.csv%60%20(79%20174%20filas)%20y%20se%20fija%20la%20lista%20de%20%60FEATURE_COLUMNS%60.%20%0A%20%20%20%20Estos%20objetos%20garantizan%20que%20la%20inferencia%20use%20**exactamente**%20las%20mismas%20transformaciones%20que%20en%20el%20entrenamiento%20(consistencia%20entre%20train%20y%20producci%C3%B3n).%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20FEATURE_COLUMNS%2C%0A%20%20%20%20NUM_NUMERIC_FEATURES%2C%0A%20%20%20%20N_STEPS%2C%0A%20%20%20%20TARGET_COLUMN_INDEX%2C%0A%20%20%20%20df_features%2C%0A%20%20%20%20le_product_id%2C%0A%20%20%20%20model%2C%0A%20%20%20%20np%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20scaler%2C%0A)%3A%0A%20%20%20%20def%20predict_demand(product_id_str%2C%20target_date_str)%3A%0A%0A%20%20%20%20%20%20%20%20%23%20Validar%20y%20Codificar%20ID%20de%20Producto%20---%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20product_id_encoded%20%3D%20le_product_id.transform(%5Bproduct_id_str%5D)%5B0%5D%0A%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20f%22Error%3A%20El%20ID%20de%20producto%20'%7Bproduct_id_str%7D'%20no%20fue%20visto%20durante%20el%20entrenamiento.%22%0A%0A%20%20%20%20%20%20%20%20%23%20validar%20fecha%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20target_date%20%3D%20pd.to_datetime(target_date_str)%0A%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20f%22Error%3A%20Formato%20de%20fecha%20incorrecto%20'%7Btarget_date_str%7D'.%22%0A%0A%20%20%20%20%20%20%20%20%23%20secuencia%20hist%C3%B3rica%0A%20%20%20%20%20%20%20%20product_data%20%3D%20df_features%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20(df_features%5B'product_id_encoded'%5D%20%3D%3D%20product_id_encoded)%0A%20%20%20%20%20%20%20%20%5D.sort_values(by%3D'created_at')%0A%0A%20%20%20%20%20%20%20%20historical_data%20%3D%20product_data%5Bproduct_data%5B'created_at'%5D%20%3C%20target_date%5D%0A%0A%20%20%20%20%20%20%20%20%23%20validar%20historia%0A%20%20%20%20%20%20%20%20if%20len(historical_data)%20%3C%20N_STEPS%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(f%22Error%3A%20No%20hay%20suficiente%20historia%20(%7Blen(historical_data)%7D%20d%C3%ADas)%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22para%20predecir.%20Se%20necesitan%20%7BN_STEPS%7D%20d%C3%ADas.%22)%0A%0A%20%20%20%20%20%20%20%20sequence_df%20%3D%20historical_data.tail(N_STEPS)%0A%20%20%20%20%20%20%20%20input_features_df%20%3D%20sequence_df%5BFEATURE_COLUMNS%5D%0A%0A%20%20%20%20%20%20%20%20input_features_scaled%20%3D%20input_features_df.astype(np.float32).values%0A%20%20%20%20%20%20%20%20input_sequence%20%3D%20np.expand_dims(input_features_scaled%2C%20axis%3D0)%0A%0A%20%20%20%20%20%20%20%20%23%20prediccion%0A%20%20%20%20%20%20%20%20pred_scaled%20%3D%20model.predict(input_sequence)%5B0%5D%5B0%5D%0A%0A%20%20%20%20%20%20%20%20%23%20des-escalar%0A%20%20%20%20%20%20%20%20dummy_pred%20%3D%20np.zeros((1%2C%20NUM_NUMERIC_FEATURES))%0A%20%20%20%20%20%20%20%20dummy_pred%5B%3A%2C%20TARGET_COLUMN_INDEX%5D%20%3D%20pred_scaled%0A%0A%20%20%20%20%20%20%20%20pred_real%20%3D%20scaler.inverse_transform(dummy_pred)%5B0%5D%5BTARGET_COLUMN_INDEX%5D%0A%0A%20%20%20%20%20%20%20%20print(%22predicci%C3%B3n%20realizada%22)%0A%20%20%20%20%20%20%20%20return%20max(0%2C%20pred_real)%0A%20%20%20%20return%20(predict_demand%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Flujo%20de%20inferencia%3A%0A%0A%20%20%20%201)%20**Validaci%C3%B3n**%3A%20%0A%20%20%20%20%20%20%20-%20%60product_id%60%20se%20transforma%20con%20%60LabelEncoder%60%3B%20si%20no%20fue%20visto%20en%20train%2C%20se%20devuelve%20un%20mensaje%20de%20error.%0A%20%20%20%20%20%20%20-%20%60target_date%60%20se%20convierte%20a%20%60datetime%60%3B%20si%20el%20formato%20es%20inv%C3%A1lido%2C%20se%20informa%20al%20usuario.%0A%0A%20%20%20%202)%20**Construcci%C3%B3n%20del%20contexto%20temporal**%3A%0A%20%20%20%20%20%20%20-%20Se%20filtra%20el%20historial%20del%20producto%20**previo**%20a%20%60target_date%60%20y%20se%20ordena%20por%20%60created_at%60.%0A%20%20%20%20%20%20%20-%20Se%20requieren%20**N_STEPS%20(%3D7)**%20observaciones%3B%20si%20no%20hay%20suficientes%20d%C3%ADas%2C%20se%20detiene%20con%20mensaje.%0A%0A%20%20%20%203)%20**Preparaci%C3%B3n%20del%20input**%3A%0A%20%20%20%20%20%20%20-%20Se%20toman%20las%20%C3%BAltimas%207%20filas%20(%60tail(N_STEPS)%60)%2C%20se%20seleccionan%20%60FEATURE_COLUMNS%60%2C%20se%20castea%20a%20%60float32%60%20y%20se%20expande%20a%20forma%20%60(1%2C%207%2C%2030)%60.%0A%0A%20%20%20%204)%20**Predicci%C3%B3n%20y%20desescalado**%3A%0A%20%20%20%20%20%20%20-%20El%20modelo%20devuelve%20%60pred_scaled%60%20en%20%5B0%2C1%5D.%20%0A%20%20%20%20%20%20%20-%20Se%20embebe%20en%20un%20vector%20%E2%80%9Cdummy%E2%80%9D%20con%20%60NUM_NUMERIC_FEATURES%60%20para%20aplicar%20%60inverse_transform%60%20y%20recuperar%20unidades%20reales%20de%20%60quantity_available%60%20(%C3%ADndice%20%60TARGET_COLUMN_INDEX%60).%0A%20%20%20%20%20%20%20-%20Se%20trunca%20a%20%60%3E%3D%200%60%20y%20se%20retorna%20el%20valor%20en%20**unidades%20de%20stock**.%0A%20%20%20%20Con%20esto%2C%20la%20funci%C3%B3n%20es%20**determinista%20y%20segura**%20ante%20entradas%20no%20vistas%20o%20con%20historial%20insuficiente%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(predict_demand)%3A%0A%20%20%20%20print(%22Prueba%201%3A%22)%0A%20%20%20%20TEST_ID%20%3D%20'PROD-00136830'%0A%20%20%20%20TEST_DATE%20%3D%20'2025-10-31'%0A%0A%20%20%20%20prediccion_1%20%3D%20predict_demand(TEST_ID%2C%20TEST_DATE)%0A%20%20%20%20print(f%22%5CnPredicci%C3%B3n%20para%20%7BTEST_ID%7D%20el%20%7BTEST_DATE%7D%3A%22)%0A%0A%20%20%20%20if%20isinstance(prediccion_1%2C%20(int%2C%20float))%3A%0A%20%20%20%20%20%20%20%20print(f%22Stock%20predicho%3A%20%7Bprediccion_1%3A.2f%7D%20unidades%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(f%22Resultado%3A%20%7Bprediccion_1%7D%22)%0A%0A%20%20%20%20print()%0A%0A%20%20%20%20print(%22Prueba%202%3A%22)%0A%20%20%20%20TEST_ID%20%3D%20'PROD-023D0E26'%0A%20%20%20%20TEST_DATE%20%3D%20'2025-10-31'%0A%0A%20%20%20%20prediccion_1%20%3D%20predict_demand(TEST_ID%2C%20TEST_DATE)%0A%20%20%20%20print(f%22%5CnPredicci%C3%B3n%20para%20%7BTEST_ID%7D%20el%20%7BTEST_DATE%7D%3A%22)%0A%0A%20%20%20%20if%20isinstance(prediccion_1%2C%20(int%2C%20float))%3A%0A%20%20%20%20%20%20%20%20print(f%22Stock%20predicho%3A%20%7Bprediccion_1%3A.2f%7D%20unidades%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(f%22Resultado%3A%20%7Bprediccion_1%7D%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">7997b2e9a376e114254c3d3fb0bb2555f5bace865570b489692f5bf311198683</marimo-code-hash>
</body>
</html>
